name: FitBot (daily)

on:
  schedule:
    - cron: "55 7 * * *"      # 09:55 local (Madrid)
    - cron: "0-30/5 8 * * *"  # 10:00..10:30 local, every 5 min
  workflow_dispatch:

jobs:
  book:
    runs-on: ubuntu-latest
    steps:
      - name: Run FitBot in Docker
        env:
          EMAIL: ${{ secrets.AH_EMAIL }}
          PASSWORD: ${{ secrets.AH_PASSWORD }}
          BOX_NAME: ${{ secrets.BOX_NAME }}
          BOX_ID: ${{ secrets.BOX_ID }}
          DAYS_IN_ADVANCE: ${{ secrets.DAYS_IN_ADVANCE }}
          FAMILY_ID: ${{ secrets.FAMILY_ID }}
          PROXY: ${{ secrets.PROXY }}
          BOOKING_GOALS_ESCAPED: ${{ secrets.BOOKING_GOALS_ESCAPED }}
        run: |
          docker run --rm \
            -e "email=${EMAIL}" \
            -e "password=${PASSWORD}" \
            -e "booking-goals=${BOOKING_GOALS_ESCAPED}" \
            -e "box-name=${BOX_NAME}" \
            -e "box-id=${BOX_ID}" \
            -e "days-in-advance=${DAYS_IN_ADVANCE}" \
            -e "family-id=${FAMILY_ID}" \
            -e "proxy=${PROXY}" \
            pablobuenaposada/fitbot
