name: FitBot (daily)

on:
  workflow_dispatch:
  
jobs:
  run:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        user:
          - name: "Sacamuelas"
            email_secret: AH_EMAIL
            password_secret: AH_PASSWORD
            booking_goals: '{"0":{"time":"0800","name":"CrossFit"},"1":{"time":"0800","name":"CrossFit"},"2":{"time":"0800","name":"CrossFit"},"3":{"time":"0800","name":"CrossFit"},"4":{"time":"0800","name":"CrossFit"}}'
          # Add more users here:
          # - name: "User 2"
          #   email_secret: AH_EMAIL_2
          #   password_secret: AH_PASSWORD_2
          #   booking_goals: '{"0":{"time":"0900","name":"CrossFit"},"1":{"time":"0900","name":"CrossFit"}}'
      fail-fast: false  # Continue running other jobs even if one fails
    name: Run fitbot for ${{ matrix.user.name }}
    steps:
      - name: Run fitbot for ${{ matrix.user.name }}
        env:
          BOOKING_GOALS: ${{ matrix.user.booking_goals }}
        run: |
          docker run \
            -e email=${{ secrets[matrix.user.email_secret] }} \
            -e password=${{ secrets[matrix.user.password_secret] }} \
            -e booking-goals="$BOOKING_GOALS" \
            -e box-name=crossfitgerak \
            -e box-id=10287 \
            -e days-in-advance=2 \
            -e proxy=${{ secrets.PROXY }} \
            pablobuenaposada/fitbot
